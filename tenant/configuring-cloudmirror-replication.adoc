---
permalink: tenant/configuring-cloudmirror-replication.html 
sidebar: sidebar 
keywords: how to configure CloudMirror replication, replication xml 
summary: O serviço de replicação do CloudMirror é um dos três serviços de plataforma StorageGRID. Você pode usar a replicação do CloudMirror para replicar automaticamente objetos para um bucket externo do S3. 
---
= Configurar a replicação do CloudMirror
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
O xref:understanding-cloudmirror-replication-service.adoc[Serviço de replicação do CloudMirror] é um dos três serviços de plataforma StorageGRID. Você pode usar a replicação do CloudMirror para replicar automaticamente objetos para um bucket externo do S3.

.O que você vai precisar
* Os serviços de plataforma devem estar habilitados para sua conta de locatário por um administrador do StorageGRID.
* Você já deve ter criado um bucket para agir como a origem da replicação.
* O endpoint que você pretende usar como destino para a replicação do CloudMirror já deve existir, e você deve ter sua URN.
* Você deve pertencer a um grupo de usuários que tenha a permissão Gerenciar todos os buckets ou acesso root, que permite gerenciar as configurações de todos os buckets do S3 em sua conta de locatário. Essas permissões substituem as configurações de permissão nas políticas de grupo ou bucket ao configurar o bucket usando o Gerenciador do locatário.


.Sobre esta tarefa
A replicação do CloudMirror copia objetos de um bucket de origem para um bucket de destino especificado em um endpoint. Para ativar a replicação do CloudMirror para um bucket, você deve criar e aplicar XML de configuração de replicação de bucket válida. O XML de configuração de replicação deve usar a URN de um endpoint de bucket do S3 para cada destino.


NOTE: A replicação não é suportada para buckets de origem ou destino com o bloqueio de objetos S3 ativado.

Para obter informações gerais sobre replicação de bucket e como configurá-la, consulte a documentação do Amazon Simple Storage Service (S3) sobre replicação entre regiões (CRR). Para obter informações sobre como o StorageGRID implementa a API de configuração de replicação de bucket do S3, consulte o xref:../s3/index.adoc[Instruções para a implementação de aplicativos cliente S3].

Se você habilitar a replicação do CloudMirror em um bucket que contém objetos, novos objetos adicionados ao bucket serão replicados, mas os objetos existentes no bucket não serão. Você deve atualizar objetos existentes para acionar a replicação.

Se você especificar uma classe de armazenamento no XML de configuração de replicação, o StorageGRID usará essa classe ao executar operações no endpoint S3 de destino. O endpoint de destino também deve suportar a classe de armazenamento especificada. Certifique-se de seguir quaisquer recomendações fornecidas pelo fornecedor do sistema de destino.

.Passos
. Habilite a replicação para o bucket de origem:
+
Use um editor de texto para criar a configuração de replicação XML necessária para habilitar a replicação, conforme especificado na API de replicação S3. Ao configurar o XML:

+
** Observe que o StorageGRID só suporta V1 da configuração de replicação. Isso significa que o StorageGRID não suporta o uso do `Filter` elemento para regras e segue convenções V1 para exclusão de versões de objetos. Consulte a documentação da Amazon sobre configuração de replicação para obter detalhes.
** Use a URNA de um endpoint de bucket S3 como o destino.
** Opcionalmente, adicione o `<StorageClass>` elemento e especifique uma das seguintes opções:
+
***  `STANDARD`: A classe de armazenamento padrão. Se você não especificar uma classe de armazenamento ao carregar um objeto, a `STANDARD` classe de armazenamento será usada.
*** `STANDARD_IA`: (Standard - Acesso não frequente.) Use essa classe de storage para dados acessados com menos frequência, mas que ainda exigem acesso rápido quando necessário.
*** `REDUCED_REDUNDANCY`: Use esta classe de armazenamento para dados não críticos e reprodutíveis que podem ser armazenados com menos redundância do que a `STANDARD` classe de armazenamento.


** Se você especificar um `Role` no XML de configuração, ele será ignorado. Este valor não é utilizado pelo StorageGRID.


+
[listing]
----
<ReplicationConfiguration>
    <Role></Role>
    <Rule>
        <Status>Enabled</Status>
        <Prefix>2020</Prefix>
        <Destination>
           <Bucket>urn:sgws:s3:::2017-records</Bucket>
           <StorageClass>STANDARD</StorageClass>
         </Destination>
     </Rule>
</ReplicationConfiguration>
----
. No Gerenciador do Locatário, selecione *STORAGE (S3)* *Buckets*.
. Selecione o nome do intervalo de origem.
+
É apresentada a página de detalhes do balde.

. Selecione *Serviços de plataforma* *replicação*.
. Marque a caixa de seleção *Ativar replicação*.
. Cole o XML de configuração de replicação na caixa de texto e selecione *Salvar alterações*.
+
image::../media/tenant_bucket_replication_configuration.png[captura de tela da caixa de diálogo configuração de replicação]

+

NOTE: Os serviços de plataforma devem estar habilitados para cada conta de locatário por um administrador do StorageGRID usando o Gerenciador de Grade ou a API de Gerenciamento de Grade. Contacte o administrador do StorageGRID se ocorrer um erro ao guardar o XML de configuração.

. Verifique se a replicação está configurada corretamente:
+
.. Adicione um objeto ao bucket de origem que atenda aos requisitos de replicação, conforme especificado na configuração de replicação.
+
No exemplo mostrado anteriormente, os objetos que correspondem ao prefixo "'2020" são replicados.

.. Confirme se o objeto foi replicado para o intervalo de destino.
+
Para objetos pequenos, a replicação acontece rapidamente.





.Informações relacionadas
xref:../s3/index.adoc[Use S3]

xref:creating-platform-services-endpoint.adoc[Criar endpoint de serviços de plataforma]
